由题可知，在这个选址问题中，我们既要给出仓库选址，也要给出大规模物资分拣中心的位置，是一个典型的多层级配送中心问题。

### 1.确定大规模物资分拣中心和仓库的数量。

以小区作为节点，做系统聚类，确保每一聚类簇中的人口不超过10w人.
聚类簇的数量即为大规模物资分拣中心的数量。
仓库数量为大规模分拣中心数量的50%。

通过系统聚类结果，一共聚出来了71个小簇，则需要71个物资分拣中心，在保证71个物资分拣中心的情况下，可以充分保证每个物资分拣中心所负责的人数不超过10万人。

则仓库需要36个。

### 2.第一层级配送中心(大规模分拣中心)选址。

所谓第一层级配送中心指的就是大规模分拣中心，物资在这里分拣完毕后应该直接送给各小区。

计算得出，比例尺约为1:0.32km。

#### 基于配送费用最少的选址模型

因为一共有71个分拣中心，则n=71。
一共有1409个小区，则m=1409。
则模型应该列为:
$\begin{cases}
    w_{ij} \ge 0 \\
    d_{ij} \ge 0 \\
    q = 0.2
\end{cases}$

$
min C = \sum_{i=1}^n \sum_{j=1}^m w_{ij} * d_{ij} * q  \\
$
模型假设:

+ 根据运输量与运输距离构建运费函数。
+ 采用地理坐标对配送中心与零售商的距离进行求解,并将其作为模型的配送中心与零售商距离数据。

---

模型变量:
$配送中心向各小区的运输费用为C \\
一共有n个配送中心,配送中心的坐标表示为(X_i,Y_i) \\
两坐标之间的距离为d_{ij} \\
一共有m个小区,小区的坐标为(x_j,y_j),其需求量为p_j,其允许配送的最大距离为D_j = 1km \\
运输单价表示为q = 0.2元/kg/km,配送中心到小区的运输费用表示为b_{ij},配送中心i到小区j的运输量为w_{ij} \\
每个分拣中心每天能够分拣的物资量为v_i
$

---

模型:
$
(1)目标函数:min C = \sum_{i=1}^n \sum_{j=1}^m w_{ij} * d_{ij} * q  \\
(2)小区的需求量必须被满足: \sum_{i=1}^nw_{ij} = p_j \\
(3)配送中心的坐标必须在长春市范围内: (X_i,Y_i) \in 长春 \\
(4)配送中心不能离小区太远: d_{ij} = [(X_i-x_j)^2 + (Y_i - y_j)^2]^{\frac{1}{2}} \le D_j  \\
(5)分拣中心每日配送量小于其承载量:\sum_{j=1}^mw_{ij} \le v_i
$

---

解法:

+ 初始化n个配送中心的坐标。
+ 通过上述模型构建每个配送中心到小区的分配方案。
+ 根据文献(见群图的条件),根据上一轮的$(X_i,Y_i)$和上一步中得到的weight方案，求解出新的坐标:

$X_i' = \frac{\sum_{j=1}^m \frac{w_{ij}qx_j}{d_{ij}}}{\sum_{j=1}^m \frac{w_{ij}q}{d_{ij}}} \\
Y_i' = \frac{\sum_{j=1}^m \frac{w_{ij}qy_j}{d_{ij}}}{\sum_{j=1}^m \frac{w_{ij}q}{d_{ij}}}$

+ 反复迭代，直到$X_i,Y_i不再变化为止。$
